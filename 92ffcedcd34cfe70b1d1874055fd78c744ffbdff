{
  "comments": [
    {
      "key": {
        "uuid": "d19b3f96_776dfaa7",
        "filename": "platform/api/udp_socket.h",
        "patchSetId": 4
      },
      "lineNbr": 66,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2019-08-12T17:55:23Z",
      "side": 1,
      "message": "I don\u0027t think the UdpSocket API should expose the NetworkRunner, since that\u0027s an implementation detail of the platform.",
      "revId": "92ffcedcd34cfe70b1d1874055fd78c744ffbdff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4c98eaa7_1622bca1",
        "filename": "platform/api/udp_socket.h",
        "patchSetId": 4
      },
      "lineNbr": 66,
      "author": {
        "id": 1330244
      },
      "writtenOn": "2019-08-13T15:29:04Z",
      "side": 1,
      "message": "The specific NetworkRunner implementation is platform-specific, but we require each platform to implement its own NetworkRunner - the interface is used throughout the higher layers\nie, in Chromium, this will just be a thin pass-through layer to assign socket callbacks plus a wrapper around the SingleThreadedTaskRunner\n\nChanging to an observer pattern as you suggest could work as well, but we would still need to provide a TaskRunner (which the NetworkRunner also is) so that we can call the read callbacks correctly. The reason I went with a NetworkRunner instead of TaskRunner, though is because:\n   1) It allows for direct calls to NetworkRunner instead of an observer pattern (see CL level comment for why)\n   2) This way, we can directly provide the NetworkRunner to the UdpReadCallback object, instead of needing the extra level fo indirection to bind the NetworkRunner to the provided callback before passing it to the UdpSocket for storage\n\nEither approach works though - I see no problem making a change to use an observer pattern, just wanted to discuss it further first",
      "parentUuid": "d19b3f96_776dfaa7",
      "revId": "92ffcedcd34cfe70b1d1874055fd78c744ffbdff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "94c6b808_cb8a2d15",
        "filename": "platform/api/udp_socket.h",
        "patchSetId": 4
      },
      "lineNbr": 66,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2019-08-13T19:44:28Z",
      "side": 1,
      "message": "OK - but with this patch, the NetworkRunner is just another TaskRunner.  All it adds to the TaskRunner is registering and removing a read callback from the UdpSocket.\n\nSo it might be simpler to just remove the NetworkRunner entirely and have the default implementation of udp_socket add/remove itself from the network reader?\n\nIt\u0027s hard to keep track of the different objects and responsibilities as the relevant APIs seem to be in flux.  Maybe we should decide on the Chrome implementation of UdpSocket before making any further changes.",
      "parentUuid": "4c98eaa7_1622bca1",
      "revId": "92ffcedcd34cfe70b1d1874055fd78c744ffbdff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a8e10cd_a199c977",
        "filename": "platform/api/udp_socket.h",
        "patchSetId": 4
      },
      "lineNbr": 66,
      "author": {
        "id": 1330244
      },
      "writtenOn": "2019-08-13T19:54:02Z",
      "side": 1,
      "message": "This might be easier to discuss in person. I\u0027ll set up a meeting with the 3 of us for tomorrow",
      "parentUuid": "94c6b808_cb8a2d15",
      "revId": "92ffcedcd34cfe70b1d1874055fd78c744ffbdff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7c1b9a21_786813cb",
        "filename": "platform/api/udp_socket.h",
        "patchSetId": 4
      },
      "lineNbr": 66,
      "author": {
        "id": 1002076
      },
      "writtenOn": "2019-08-13T20:21:33Z",
      "side": 1,
      "message": "\u003e we require each platform to implement its own NetworkRunner\n\nI thought NetworkRunner was OSP-standalone only? Why not just have platforms implement UDPSocket itself?",
      "parentUuid": "8a8e10cd_a199c977",
      "revId": "92ffcedcd34cfe70b1d1874055fd78c744ffbdff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "540d2472_829da434",
        "filename": "platform/api/udp_socket.h",
        "patchSetId": 4
      },
      "lineNbr": 66,
      "author": {
        "id": 1330244
      },
      "writtenOn": "2019-08-13T20:23:32Z",
      "side": 1,
      "message": "The NetworkRunner is used throughout the OSP code (and by now, I\u0027d assume the CastLib code) as a way to assign callbacks for reads. This is why the interface is in platform/api instead of platform/impl\n\nIf we move the callbacks to the UdpSockets, this could be changed as a next step",
      "parentUuid": "7c1b9a21_786813cb",
      "revId": "92ffcedcd34cfe70b1d1874055fd78c744ffbdff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c1f4e6ab_6c40396b",
        "filename": "platform/impl/network_runner.cc",
        "patchSetId": 4
      },
      "lineNbr": 16,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2019-08-13T19:44:28Z",
      "side": 1,
      "message": "You don\u0027t need to explicitly invoke the no-arg constructor here.",
      "revId": "92ffcedcd34cfe70b1d1874055fd78c744ffbdff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}